import{d as u}from"./chunk-H7W7OBCP.js";import{P as i,U as o,j as c,r as a,y as l}from"./chunk-43GAKS5M.js";var s=(()=>{class e{_eventBus;constructor(){this._eventBus=new c}broadcast(r,t){this._eventBus.next({key:r,data:t})}on(r){return this._eventBus.asObservable().pipe(l(t=>t.key===r),a(t=>t.data))}static \u0275fac=function(t){return new(t||e)};static \u0275prov=i({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var f=(()=>{class e{http;broadcastService;static UserLoginEventName="UserLogin";static UserLogoutEventName="UserLogout";loginPromise=null;logoutPromise=null;constructor(r,t){this.http=r,this.broadcastService=t}login(r,t){return r=="user@ecommerce.com"&&t=="1234"?(this.broadcastService.broadcast(e.UserLoginEventName,{email:r,password:t}),this.loginPromise=Promise.resolve(!0)):this.loginPromise=Promise.reject("Invalid credentials"),this.loginPromise}logout(){return this.broadcastService.broadcast(e.UserLoginEventName,null),this.logoutPromise=Promise.resolve(),this.logoutPromise}static \u0275fac=function(t){return new(t||e)(o(u),o(s))};static \u0275prov=i({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var n=(()=>{class e{static ApplicationPrefix="ecommerce";static setItem(r,t){t==null?localStorage.removeItem(`${e.ApplicationPrefix}.${r}`):localStorage.setItem(`${e.ApplicationPrefix}.${r}`,JSON.stringify(t))}static getItem(r){let t=localStorage.getItem(`${e.ApplicationPrefix}.${r}`);if(t==null)return null;try{return JSON.parse(t)}catch{return null}}}return e})();var S=(()=>{class e{broadcastService;static CurrentUserChangedEventName="CurrentUserChanged";currentUserKey="current-user";_currentUser=n.getItem(this.currentUserKey);constructor(r){this.broadcastService=r,this.broadcastService.on(f.UserLoginEventName).subscribe(t=>{this.setCurrentUser(t)})}get isLogged(){return!!this._currentUser}get currentUser(){return this._currentUser}setCurrentUser(r){this._currentUser=r,n.setItem(this.currentUserKey,this._currentUser)}static \u0275fac=function(t){return new(t||e)(o(s))};static \u0275prov=i({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();export{f as a,n as b,S as c};
